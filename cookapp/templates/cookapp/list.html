{% extends "cookapp/base.html" %}
{% load cookapp_extras %}
{% load staticfiles%}
{% block link %}
    <link href="{% static 'css/archieve.css' %}" rel="stylesheet">
    <link href="{% static 'css/mobile_arch.css' %}" rel="stylesheet">
{% endblock link%}
{% block content %}
    
<!-- ****** Breadcumb Area Start ****** -->
    <div class="breadcumb-area" style="background-image: url(/static/img/bg-img/breadcumb.jpg);">
        <div class="container h-100">
            <div class="row h-100 align-items-center">
                <div class="col-12">
                    <div class="bradcumb-title text-center">
                        <h2>Archive Page</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="breadcumb-nav">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="#"><i class="fa fa-home" aria-hidden="true"></i> Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Archive Page</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    <!-- ****** Breadcumb Area End ****** -->

    <!-- ****** Archive Area Start ****** -->
    <input type="text"/>
    <section class="archive-area section_padding_80 d-flex justify-content-center">
        <div>
        <input type="button" onclick="hideandshow1(this), changebutton()" class="addButton" value="재료 하나 추가!" id="addButton"/>
        </div>
        <div class="container">
            <div class="row">
               
                <!--{% init_counter %}-->
                <!--{% init_delay_counter %}-->
                {% for recipe in recipes %}

                <!-- Single Post -->
                <div class="col-12 col-md-6 col-lg-4" name="recipe">
                    <div class="single-post wow fadeInUp" data-wow-delay="{% delay_counter %}s">
                        <!-- Post Thumb -->
                        <div class="post-thumb">
                        {% comment %} 썸네일 넣는 공간 {% endcomment %}
                            <img src="{{recipe.image_thumbnail.url}}" alt="">
                        </div>
                        <!-- Post Content -->
                        <div class="post-content">
                            <div class="post-meta d-flex">
                                <div class="post-author-date-area d-flex">
                                    <!-- Post Author -->
                                        <div class="post-author">
                                            <a href="#">관리자</a>
                                        </div>
                                    {% comment %} <!-- Post Date -->
                                    <div class="post-date">
                                        <a href="#">May 19, 2017</a>
                                    </div> {% endcomment %}
                                </div>
                                <!-- Post Comment & Share Area -->
                                <div class="post-comment-share-area d-flex">
                                    <!-- Post Favourite -->
                                    <div class="post-favourite">
                                        <a href="#" disabled="disabled"><i class="fa fa-eye" aria-hidden="true"></i>{{recipe.see}}</a>
                                    </div>
                                    <!-- Post Comments -->
                                    {% comment %} <div class="post-comments">
                                        <a href="#"><i class="fa fa-comment-o" aria-hidden="true"></i> 12</a>
                                    </div> {% endcomment %}
                                    <!-- 공유기능--> 
                                    <!-- Post Share -->
                                    <div class="post-share">
                                        <a target="_blank" href="{{recipe.url}}"><i class="fa fa-share-alt" aria-hidden="true"></i></a>
                                    </div>
                                </div>
                            </div>
                            <a href="#" onclick="view_user(this)" name="{{forloop.counter}}" _id="{{recipe.id}}">
                            {% comment %} 레시피 요리 이름 {% endcomment %}
                                <h6 class="post-headline food-time text-center">{{recipe.time}}<h6>
                                <h4 class="post-headline text-center">{{recipe.name}}</h4>
                            </a>
                            <div id="popup_user{{forloop.counter}}" class="Pstyle popup_user">
                                <span class="b-close">
                                        <button class="iKon" onclick="byebye(this)" name="{{forloop.counter}}">x</button>
                                </span>
                                     <div class="content2" style=""> 
                                      <div><h1>{{recipe.name}}</h1><br></div>
                                      <div class="youtube_div"``>
                                            <iframe 
                                            height="100%" width="100%" class="youtube_player"
                                            id="youtube_player_{{forloop.counter}}"
                                            src="{{recipe.convert_youtube}}"
                                            frameborder="0" allow="accelerometer; autoplay; encrypted-media;
                                             gyroscope; picture-in-picture" allowfullscreen
                                             style="overflow:hidden;height:400px; width:100%" ></iframe>
                                          
                                     </div>
                                     <div><br><h3>레시피</h3>
                                        <p>
                                            {{recipe.content|linebreaks}}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}

                

                {% for recipe in add %}

                <!-- Single Post -->
                <div class="col-12 col-md-6 col-lg-4" name="add-recipe" style="display:none;">
                    <div class="single-post wow fadeInUp" data-wow-delay="{% delay_counter %}s">
                        <!-- Post Thumb -->
                        <div class="post-thumb">
                        {% comment %} 썸네일 넣는 공간 {% endcomment %}
                            <img src="{{recipe.image_thumbnail.url}}" alt="">
                        </div>
                        <!-- Post Content -->
                        <div class="post-content">
                            <div class="post-meta d-flex">
                                <div class="post-author-date-area d-flex">
                                    <!-- Post Author -->
                                        <div class="post-author">
                                            <a href="#">관리자</a>
                                        </div>
                                    {% comment %} <!-- Post Date -->
                                    <div class="post-date">
                                        <a href="#">May 19, 2017</a>
                                    </div> {% endcomment %}
                                </div>
                                <!-- Post Comment & Share Area -->
                                <div class="post-comment-share-area d-flex">
                                    <!-- Post Favourite -->
                                    <div class="post-favourite">
                                        <a href="#" disabled="disabled"><i class="fa fa-eye" aria-hidden="true"></i>{{recipe.see}}</a>
                                    </div>
                                    <!-- Post Comments -->
                                    {% comment %} <div class="post-comments">
                                        <a href="#"><i class="fa fa-comment-o" aria-hidden="true"></i> 12</a>
                                    </div> {% endcomment %}
                                    <!-- 공유기능--> 
                                    <!-- Post Share -->
                                    <div class="post-share">
                                        <a target="_blank" href="{{recipe.url}}"><i class="fa fa-share-alt" aria-hidden="true"></i></a>
                                    </div>
                                </div>
                            </div>
                            <a href="#" onclick="view_user(this)" name="{{forloop.counter}}" _id="{{recipe.id}}">
                            {% comment %} 레시피 요리 이름 {% endcomment %}
                                <h6 class="post-headline food-time text-center">{{recipe.time}}<h6>
                                <h4 class="post-headline text-center">{{recipe.name}}</h4>
                            </a>
                            <div id="popup_user{{forloop.counter}}" class="Pstyle popup_user">
                                <span class="b-close">
                                        <button class="iKon" onclick="byebye(this)" name="{{forloop.counter}}">x</button>
                                </span>
                                     <div class="content2" style=""> 
                                      <div><h1>{{recipe.name}}</h1><br></div>
                                      <div class="youtube_div">
                                            <iframe 
                                            height="100%" width="100%" class="youtube_player"
                                            id="youtube_player_{{forloop.counter}}"
                                            src="{{recipe.convert_youtube}}"
                                            frameborder="0" allow="accelerometer; autoplay; encrypted-media;
                                             gyroscope; picture-in-picture" allowfullscreen
                                             style="overflow:hidden;height:400px; width:100%" ></iframe>
                                          
                                     </div>
                                     <div><br><h3>레시피</h3>
                                        <p>
                                            {{recipe.content|linebreaks}}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% comment %} <div class="col-12">
                    <div class="pagination-area d-sm-flex mt-15">
                        <nav aria-label="#">
                            <ul class="pagination">
                                <li class="page-item active">
                                    <a class="page-link" href="#">1 <span class="sr-only">(current)</span></a>
                                </li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Next <i class="fa fa-angle-double-right" aria-hidden="true"></i></a>
                                </li>
                            </ul>
                        </nav>
                        <div class="page-status">
                            <p>Page 1 of 60 results</p>
                        </div>
                    </div>
                </div> {% endcomment %}

            </div>
        </div>
    </section>
    <!-- ****** Archive Area End ****** -->

{% endblock content %}
{% block script%}
<script src="{% static 'js/jquery/jquery.bpopup.js' %}"></script>
<script src="{% static 'js/jquery/jquery.bpopup.min.js' %}"></script>
<script>


function view_user(elem) {
    var id = elem.getAttribute("name");
    var _id = elem.getAttribute("_id");
    $.ajax({ url: "/see/".concat(_id), // 클라이언트가 HTTP 요청을 보낼 서버의 URL 주소 data: { name: "홍길동" }, // HTTP 요청과 함께 서버로 보낼 데이터 
    method: "GET", // HTTP 요청 메소드(GET, POST 등) 
    dataType: "json" // 서버에서 보내줄 데이터의 타입 
    });

    $("#popup_user".concat(id)).bPopup({ 
            modalClose: false,
            opacity: 0.6,
            positionStyle: 'fixed'
    }); 
    var position = ($(window).width())/4;
    $("#popup_user".concat(id)).css("left",position.toString().concat("px"));
    var width = $("#youtube_player_".concat(id)).width();
    console.log(width);
    $("#youtube_player_".concat(id)).css("height",width*9/16);
}
function byebye(elem){

    var id = elem.getAttribute("name");
    $("#youtube_player_".concat(id))[0].contentWindow.postMessage('{"event":"command","func":"' + 'stopVideo' + '","args":""}', '*'); 
    $("#popup_user").bPopup().close();
}

function hideandshow1(elem) {
    var add = elem.getAttribute("value")==="재료 하나 추가!";
    if(add == true){
        document.getElementsByName("recipe").forEach(function(elem){
            elem.style.display = "none";
        });
        document.getElementsByName("add-recipe").forEach(function(elem){
            elem.style.display = "block";
        });
    }else{
        document.getElementsByName("recipe").forEach(function(elem){
            elem.style.display = "block";
        });
        document.getElementsByName("add-recipe").forEach(function(elem){
            elem.style.display = "none";
        });    
    }


}

function changebutton() {
    var elem = document.getElementById("addButton");
    if (elem.value=="재료 하나 추가!") elem.value = "원래 재료 보기!";
    else elem.value = "재료 하나 추가!";
}

$( document ).ready( function() {
    $( window ).resize( function() {
        var width = $(window).width();
        console.log(width/2-50);
        $(".youtube_player").css("height",(width/2-50)*9/16);
    } );
} );

</script>
{% endblock script%}
